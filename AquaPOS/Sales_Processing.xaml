<Window x:Class="AquaPOS.Sales_Processing"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AquaPOS"
        mc:Ignorable="d"
        Icon="pack://application:,,,/resources/Images/App_Logo/AquaPOS_Logo_Icon_New.ico" 
        Title="Sales Processing" Height="720" Width="1280" ResizeMode="CanResize" WindowStartupLocation="CenterScreen">

    <Window.Background>
        <ImageBrush ImageSource="pack://application:,,,/resources/Images/Background_Images/Main_Background_Image.png"
            Stretch="Fill"/>
    </Window.Background>

    <Window.Resources>
        <!-- Rounded Button Style -->
        <Style x:Key="RoundedButtonStyle" TargetType="Button">
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border 
                            x:Name="border"
                            Background="{TemplateBinding Background}" 
                            BorderBrush="{TemplateBinding BorderBrush}" 
                            BorderThickness="{TemplateBinding BorderThickness}" 
                            CornerRadius="20"
                            SnapsToDevicePixels="True">
                            <ContentPresenter 
                                HorizontalAlignment="Center" 
                                VerticalAlignment="Center" 
                                RecognizesAccessKey="True"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <!-- Hover: Scale up -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleX)"
                                         To="1.05" Duration="0:0:0.1"/>
                                            <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleY)"
                                         To="1.05" Duration="0:0:0.1"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleX)"
                                         To="1" Duration="0:0:0.1"/>
                                            <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleY)"
                                         To="1" Duration="0:0:0.1"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>

                            <!-- Click: Quick bounce effect -->
                            <EventTrigger RoutedEvent="Button.Click">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleX)"
                                     To="0.95" Duration="0:0:0.05" AutoReverse="True"/>
                                        <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleY)"
                                     To="0.95" Duration="0:0:0.05" AutoReverse="True"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Rounded Text Box Style -->
        <Style x:Key="RoundedTextBoxStyle" TargetType="Control">
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Control">
                        <Border CornerRadius="8" 
                            BorderBrush="#FF0807A0" 
                            BorderThickness="2.5" 
                            Background="White">
                            <ScrollViewer Margin="5" x:Name="PART_ContentHost"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>

            <Style.Triggers>
                <!-- Alive animation on focus -->
                <Trigger Property="IsKeyboardFocused" Value="True">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                         To="1.03" Duration="0:0:0.08"/>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                         To="1.03" Duration="0:0:0.08"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                         To="1" Duration="0:0:0.08"/>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                         To="1" Duration="0:0:0.08"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.ExitActions>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Merged Icon Alive Button Style -->
        <Style x:Key="MergedIconAliveButtonStyle" TargetType="Button">
            <!-- From IconButtonStyle -->
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="Focusable" Value="False"/>

            <!-- From AliveIconButtonStyle -->
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                </Setter.Value>
            </Setter>

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <!-- Hover: Scale up -->
                            <Trigger Property="IsMouseOver" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleX)"
                                             To="1.2" Duration="0:0:0.1"/>
                                            <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleY)"
                                             To="1.2" Duration="0:0:0.1"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleX)"
                                             To="1" Duration="0:0:0.1"/>
                                            <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleY)"
                                             To="1" Duration="0:0:0.1"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>

                            <!-- Click: Quick bounce effect -->
                            <EventTrigger RoutedEvent="Button.Click">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleX)"
                                         To="0.9" Duration="0:0:0.05" AutoReverse="True"/>
                                        <DoubleAnimation Storyboard.TargetProperty="(Button.RenderTransform).(ScaleTransform.ScaleY)"
                                         To="0.9" Duration="0:0:0.05" AutoReverse="True"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

    </Window.Resources>

    <Grid Grid.Column="1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="260"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>

        <!-- Sidebar Panel -->
        <Border Background="#FF031C36" Width="260" HorizontalAlignment="Left">
            <StackPanel>

                <!-- Side Bar -->
                <!-- Logo -->
                <Image Source="pack://application:,,,/resources/Images/App_Logo/AquaPOS_Logo.png"
                   Width="244" Height="176"/>

                <!-- Search  Product Details Panel of Side Bar -->
                <Border Background="#FFCAD8E5" BorderBrush="#FF0807A0" BorderThickness="2.5" Width="220" CornerRadius="20" HorizontalAlignment="Left" Margin="20,0,0,0" Height="440">
                    <StackPanel>
                        <WrapPanel Margin="5,5,5,5">

                            <!-- Search Title -->
                            <TextBlock Text="PRODUCT DETAILS" FontSize="16" FontWeight="Bold" Foreground="#FF1D1B1B" Margin="20,20,20,20" TextAlignment="Left"/>

                            <StackPanel Orientation="Horizontal" Margin="16,0,0,10">
                                <ComboBox x:Name="cmbSearchProductDetails"
                                          Width="138" Height="32"
                                          IsEditable="True"
                                          StaysOpenOnEdit="True"
                                          BorderBrush="#FF0807A0" BorderThickness="2.5"
                                          HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                                          Loaded="CmbSearchProduct_Loaded"
                                          IsTextSearchEnabled="True"
                                          PreviewTextInput="CmbSearchProduct_PreviewTextInput"
                                          SelectionChanged="CmbSearchProductDetails_SelectionChanged"/>
                                <Button Width="32" Height="32" Margin="2,0,0,0" BorderBrush="#FF73AEFF" BorderThickness="1.5" Click="SearchProductDetails_Click">
                                    <Image Source="/Resources/Images/Button_Icons/Search_Icon.png" Stretch="Uniform" Height="20" Width="20" />
                                </Button>
                            </StackPanel>


                            <!-- Result Fields -->
                            <StackPanel Width="200" Height="300" Margin="5,15,5,5">

                                <!-- Product Name -->
                                <StackPanel Margin="0,0,0,20">
                                    <TextBlock Text="Product Name" FontSize="14" Foreground="Black" Height="24" Width="168"/>
                                    <TextBox x:Name="txtProductNameResult" Width="180" Height="32"
                                        Style="{StaticResource RoundedTextBoxStyle}" TextChanged="TxtProductNameResult_TextChanged"/>
                                </StackPanel>

                                <!-- Category -->
                                <StackPanel Margin="0,0,0,20">
                                    <TextBlock Text="Category" FontSize="14" Foreground="Black" Height="24" Width="168"/>
                                    <TextBox x:Name="txtCategoryResult" Width="180" Height="32"
                                         Style="{StaticResource RoundedTextBoxStyle}" TextChanged="TxtCategoryResult_TextChanged"/>
                                </StackPanel>

                                <!-- Unit Price -->
                                <StackPanel Margin="0,0,0,20">
                                    <TextBlock Text="Unit Price" FontSize="14" Foreground="Black" Height="22" Width="168"/>
                                    <TextBox x:Name="txtUnitPriceResult" Width="180" Height="32"
                                         Style="{StaticResource RoundedTextBoxStyle}" TextChanged="TxtUnitPriceResult_TextChanged"/>
                                </StackPanel>

                                <!-- Available Quantity -->
                                <StackPanel Margin="0,0,0,20">
                                    <TextBlock Text="Available Quantity" FontSize="14" Foreground="Black" Height="22" Width="168"/>
                                    <TextBox x:Name="txtAvailableQtyResult" Width="180" Height="32"
                                         Style="{StaticResource RoundedTextBoxStyle}" TextChanged="TxtAvailableQtyResult_TextChanged"/>
                                </StackPanel>
                            </StackPanel>
                        </WrapPanel>
                    </StackPanel>
                </Border>

                <!-- Exit Button with Underlined Text -->
                <Button 
                    Width="100"
                    Height="40"
                    FontSize="16"
                    Background="Transparent"
                    Foreground="White"
                    BorderBrush="Transparent"
                    BorderThickness="2"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Margin="0,10,0,0" Click="ExitButton_Click">
                    <TextBlock Text="EXIT" 
                       Foreground="White"
                       TextDecorations="Underline"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"/>
                </Button>

            </StackPanel>
        </Border>

        <Border Grid.Column="2" 
            Background="#FFCBD6E2" 
            BorderBrush="#FF0807A0" 
            BorderThickness="2.5" 
            CornerRadius="10" 
            Padding="20" 
            Margin="20" 
            HorizontalAlignment="Left" Width="220">


            <StackPanel Margin="0,3,0,0">

                <TextBlock Text="BILLING" FontSize="16" FontWeight="Bold" Foreground="#FF1D1B1B" Margin="2,10,0,0" TextAlignment="Left"/>

                <!-- Bill Date Label & DatePicker -->
                <Label Content="Bill Date" Foreground="Black" FontSize="16" FontWeight="Normal" 
                       HorizontalAlignment="Center" Margin="0,30,0,0" FontFamily="Segoe UI Variable Display Semibold"/>
                <DatePicker x:Name="BillDatePicker" Width="170" Height="28" FontSize="14" 
                            BorderBrush="#FF73AEFF" BorderThickness="1" HorizontalAlignment="Center"/>

                <!-- Product Name Label & Search ComboBox -->
                <Label Content="Product Name" Foreground="Black" FontSize="16"
                        HorizontalAlignment="Center" Margin="0,20,0,0" FontFamily="Segoe UI Variable Small Semibold" FontWeight="Normal"/>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <ComboBox x:Name="cmbSearchProduct"
                              Width="138" Height="32"
                              IsEditable="True"
                              StaysOpenOnEdit="True"
                              BorderBrush="#FF73AEFF" BorderThickness="2.5"
                              HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                              Loaded="CmbSearchProduct_Loaded"
                              IsTextSearchEnabled="True"
                              PreviewTextInput="CmbSearchProduct_PreviewTextInput"
                              SelectionChanged="CmbSearchProductDetails_SelectionChanged" Background="{DynamicResource {x:Static SystemColors.ActiveCaptionBrushKey}}"/>
                    <Button Width="32" Height="32" Margin="2,0,0,0" BorderBrush="#FF73AEFF" BorderThickness="1.5" Click="SearchProduct_Click">
                        <Image Source="/Resources/Images/Button_Icons/Search_Icon.png" Stretch="Uniform" Height="20" Width="20" />
                    </Button>
                </StackPanel>


                <!-- Quantity Label & TextBox -->
                <Label Content="Quantity" Foreground="Black" FontSize="16" FontWeight="Normal" 
                       HorizontalAlignment="Center" Margin="0,10,0,0" FontFamily="Segoe UI Variable Text Semibold"/>
                <TextBox x:Name="QuantityTextBox" Width="170" Height="32" FontSize="14"
                         Style="{StaticResource RoundedTextBoxStyle}"
                         HorizontalAlignment="Center" BorderBrush="#FF0807A0" BorderThickness="1"/>

                <!-- Add to Bill Button -->
                <Button x:Name="AddToBillButton" Content="ADD TO BILL" Width="130" Height="34" FontSize="14" FontFamily="Segoe UI Semibold" 
                        Foreground="Black" Background="#FF8BF1ED" BorderBrush="#FF377EDF" BorderThickness="1.5"
                        Style="{StaticResource RoundedButtonStyle}"
                        HorizontalAlignment="Center" Margin="0,30,0,0" Click="AddToBillButton_Click"/>

                <!-- Total Amount Display -->
                <StackPanel Margin="0,60,0,0" HorizontalAlignment="Center">
                    <Label Content="Total Amount (Rs.) :" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" FontFamily="Segoe UI Variable Text"/>
                    <TextBlock x:Name="TotalAmountTextBlock" Text="0.00" FontSize="16" FontWeight="Bold" 
               Foreground="#FF0807A0" HorizontalAlignment="Center"/>
                </StackPanel>

                <!-- Print Bill Button -->
                <Button x:Name="PrintBillButton" Content="PRINT BILL" Width="130" Height="34" FontSize="14" FontFamily="Segoe UI Semibold"
                        Foreground="Black" Background="#FF9DFF59" BorderBrush="#FF15A90E" BorderThickness="1"
                        Style="{StaticResource RoundedButtonStyle}"
                        HorizontalAlignment="Center" Margin="0,25,0,0" Click="PrintBillButton_Click"/>
            </StackPanel>
        </Border>

        <!-- Billing Table -->
        <Grid Grid.Column="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" MinWidth="866"/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>

            <Border 
                BorderBrush="#FF0807A0" 
                BorderThickness="2.5" 
                CornerRadius="10" 
                Padding="2" 
                Background="White" 
                Margin="260,20,20,20" Grid.ColumnSpan="2">
                <DataGrid x:Name="BillDataGrid"
                  AutoGenerateColumns="False"
                  GridLinesVisibility="All"
                  HeadersVisibility="Column"
                  RowHeight="24"
                  Background="White"
                  AlternatingRowBackground="#FFEFEFEF"
                  FontSize="12"
                  FontFamily="Segoe UI"
                  SelectionChanged="StockDataGrid_SelectionChanged_1"
                  BorderBrush="#FFD7E3FA"
                  BorderThickness="1"
                  HorizontalGridLinesBrush="Transparent"
                  VerticalGridLinesBrush="Transparent" Margin="5,5,5,5"
                  Grid.Row="2" Grid.Column="0"
                  CanUserAddRows="False"
                  IsReadOnly="True"
                  ItemsSource="{Binding Stocks}"
                  VerticalScrollBarVisibility="Visible">

                    <DataGrid.Resources>
                        <Style TargetType="{x:Type DataGridCell}">
                            <Setter Property="BorderBrush" Value="#FFD3D3D3"/>
                            <Setter Property="Foreground" Value="Black"/>
                            <Setter Property="BorderThickness" Value="0,0,1,1"/>
                            <Setter Property="Padding" Value="5,0,5,0"/>
                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                        </Style>

                        <Style TargetType="{x:Type DataGridColumnHeader}">
                            <Setter Property="Background" Value="#FF093564"/>
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                            <Setter Property="VerticalContentAlignment" Value="Center"/>
                            <Setter Property="Height" Value="30"/>
                            <Setter Property="BorderBrush" Value="#FFD3D3D3"/>
                            <Setter Property="BorderThickness" Value="0,0,2,1"/>
                        </Style>

                        <Style x:Key="CenterTextStyle" TargetType="{x:Type TextBlock}">
                            <Setter Property="HorizontalAlignment" Value="Center"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                        </Style>
                    </DataGrid.Resources>

                    <!-- ✅ 2. Columns -->
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Product ID" Binding="{Binding ProductID}" Width="100"
                        ElementStyle="{StaticResource CenterTextStyle}"/>
                        <DataGridTextColumn Header="Product Name" Binding="{Binding ProductName}" Width="160"
                        ElementStyle="{StaticResource CenterTextStyle}"/>
                        <DataGridTextColumn Header="Unit Price (Rs.)" Binding="{Binding UnitPrice}" Width="120"
                        ElementStyle="{StaticResource CenterTextStyle}"/>
                        <DataGridTextColumn Header="Quantity" Binding="{Binding Quantity}" Width="100"
                        ElementStyle="{StaticResource CenterTextStyle}"/>
                        <DataGridTextColumn Header="Total Price (Rs.)" Binding="{Binding TotalPrice}" Width="120"
                        ElementStyle="{StaticResource CenterTextStyle}"/>

                        <DataGridTemplateColumn Header="Actions" Width="100">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <!-- Delete Button -->
                                        <Button Style="{StaticResource MergedIconAliveButtonStyle}"
                                                Click="DeleteButton_Click"
                                                CommandParameter="{Binding}"
                                                ToolTip="Delete"
                                                Background="Transparent"
                                                BorderBrush="Transparent"
                                                Cursor="Hand"
                                                Padding="0,0,10,0">
                                            <Image Source="pack://application:,,,/Resources/Images/Button_Icons/Delete_Button_Icon.png"
                                                       Width="20" Height="20"
                                                       Stretch="Uniform"/>
                                        </Button>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>
        </Grid>
    </Grid>
</Window>
